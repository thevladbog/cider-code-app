# Yandex Cloud Logging Integration - Final Status

## ‚úÖ –ü–†–û–ï–ö–¢ –ó–ê–í–ï–†–®–ï–ù –£–°–ü–ï–®–ù–û

### üéØ –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞:

–ù–∞—Å—Ç—Ä–æ–µ–Ω–æ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Yandex Cloud Logging –¥–ª—è Electron-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–æ–π –ª–æ–≥–æ–≤ –≤ –æ–±–ª–∞–∫–æ.

## üìä –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

### ‚úÖ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢:

1. **SDK-–ª–æ–≥–≥–µ—Ä (yandexCloudLoggerSDK.ts)** - ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –†–ê–ë–û–ß–ò–ô

   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π `@yandex-cloud/nodejs-sdk`
   - –£—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏ –≤ Yandex Cloud Logging
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ —Ç–∏–ø—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (SA Key, IAM, OAuth)
   - –†–∞–±–æ—Ç–∞–µ—Ç batch-–æ—Ç–ø—Ä–∞–≤–∫–∞ –ª–æ–≥–æ–≤
   - –ò–º–µ–µ—Ç fallback –Ω–∞ –∫–æ–Ω—Å–æ–ª—å –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
   - ‚úÖ **–ù–û–í–û–ï**: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è environment —á–µ—Ä–µ–∑ VITE_APP_ENV
   - ‚úÖ **–ù–û–í–û–ï**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API URL –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç environment
   - ‚úÖ **–ù–û–í–û–ï**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ development, production, staging, beta, testing –æ–∫—Ä—É–∂–µ–Ω–∏–π

2. **Environment Support** - ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û:

   - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ environment –∏–∑ VITE_APP_ENV/NODE_ENV/APP_ENVIRONMENT
   - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ environment, appVersion, platform, arch –∫ –ª–æ–≥–∞–º
   - ‚úÖ –ú–µ—Ç–æ–¥—ã getEnvironment() –∏ setEnvironment() –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
   - ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–æ–≤ –ø–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è–º –≤ Yandex Cloud
   - ‚úÖ **–ù–û–í–û–ï**: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ `src/utils/environment.ts`
   - ‚úÖ **–ù–û–í–û–ï**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ environment

3. **API Integration** - ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ò–ù–¢–ï–ì–†–ò–†–û–í–ê–ù–û:

   - ‚úÖ API –∫–æ–Ω—Ñ–∏–≥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç URL –ø–æ environment
   - ‚úÖ Development: `https://api.test.in.bottlecode.app:3035`
   - ‚úÖ Beta/Staging: `https://beta.api.bottlecode.app`
   - ‚úÖ Production: `https://api.bottlecode.app`

4. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - ‚úÖ –í–°–ï –¢–ò–ü–´ –ü–û–î–î–ï–†–ñ–ò–í–ê–Æ–¢–°–Ø:

   - ‚úÖ Service Account Key (JWT –≥–µ–Ω–µ—Ä–∞—Ü–∏—è + IAM —Ç–æ–∫–µ–Ω)
   - ‚úÖ IAM —Ç–æ–∫–µ–Ω—ã
   - ‚úÖ OAuth —Ç–æ–∫–µ–Ω—ã

5. **Fallback —Å–∏—Å—Ç–µ–º–∞** - ‚úÖ –†–ê–ë–û–¢–ê–ï–¢:
   - –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å
   - –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ —Å–±–æ–µ–≤

### ‚ùå –ß–¢–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢ –ò –ü–û–ß–ï–ú–£:

1. **REST API –ª–æ–≥–≥–µ—Ä (yandexCloudLogger.ts)** - ‚ùå –ù–ï –†–ê–ë–û–¢–ê–ï–¢
   - Yandex Cloud Logging **–ù–ï –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–¢ REST/HTTP API** –¥–ª—è ingestion –ª–æ–≥–æ–≤
   - –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404 (Not Found)
   - –¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ gRPC/SDK –ø–æ–¥—Ö–æ–¥

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –†–∞–±–æ—á–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

```
Electron App
    ‚Üì
YandexCloudLoggerSDK
    ‚Üì
@yandex-cloud/nodejs-sdk
    ‚Üì
gRPC connection
    ‚Üì
Yandex Cloud Logging
```

### –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
src/services/
‚îú‚îÄ‚îÄ yandexCloudLoggerSDK.ts      ‚úÖ –û–°–ù–û–í–ù–û–ô –†–ê–ë–û–ß–ò–ô –õ–û–ì–ì–ï–†
‚îú‚îÄ‚îÄ yandexCloudLogger.ts         ‚ùå –£–°–¢–ê–†–ï–í–®–ò–ô (REST API)
‚îú‚îÄ‚îÄ loggerConfig.ts              ‚úÖ –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
‚îú‚îÄ‚îÄ loggerTest.ts                ‚úÖ –ü–†–û–°–¢–´–ï –¢–ï–°–¢–´
‚îî‚îÄ‚îÄ loggerTestComprehensive.ts   ‚úÖ –ü–û–õ–ù–´–ï –¢–ï–°–¢–´
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

### –†–∞–±–æ—á–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
YANDEX_CLOUD_LOGGING_ENABLED=true
YANDEX_USE_SDK=true
YANDEX_IAM_TOKEN=t1.9euel...
YANDEX_FOLDER_ID=b1gqqc57725dmf2m76b9
YANDEX_LOG_GROUP_ID=e236sdehalvdh3otipp3
APP_INSTANCE_ID=bottle-code-app-local-1
YANDEX_SERVICE_ACCOUNT_KEY={"id":"ajeek39...","service_account_id":"ajej1qt...","private_key":"-----BEGIN PRIVATE KEY-----..."}
```

## üìù –¢–µ—Å—Ç—ã –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ —Ç–µ—Å—Ç—ã:

- `npm run test:logger:sdk` - SDK –ª–æ–≥–≥–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
- `npm run test:logger:comprehensive` - –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í—Å–µ –ª–æ–≥–∏ –¥–æ—Ö–æ–¥—è—Ç –¥–æ Yandex Cloud Logging
- Response: `{ '$type': 'yandex.cloud.logging.v1.WriteResponse', errors: {} }`

### üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –æ–±–ª–∞–∫–µ:

–õ–æ–≥–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–¥–µ—Å—å: https://console.yandex.cloud/folders/b1gqqc57725dmf2m76b9/logging

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã:

```json
{
  "@yandex-cloud/nodejs-sdk": "^2.7.0",
  "jsonwebtoken": "^9.0.2",
  "@types/jsonwebtoken": "^9.0.7",
  "axios": "^1.10.0",
  "dotenv": "^16.4.7"
}
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SDK-–ª–æ–≥–≥–µ—Ä–∞:

```typescript
import { createSDKLoggerConfig } from './services/loggerConfig';
import { YandexCloudLoggerSDK } from './services/yandexCloudLoggerSDK';

const config = createSDKLoggerConfig();
const logger = new YandexCloudLoggerSDK(config);
await logger.initialize();

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
await logger.info('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ', { version: '1.0.0' });
await logger.error('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞', { error: 'details' });

// Environment –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –ª–æ–≥–∞–º:
// jsonPayload –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å: { version: '1.0.0', environment: 'development', appVersion: '1.0.0-beta.18', platform: 'win32', arch: 'x64' }
```

### Environment —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

```typescript
// –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π environment
const currentEnv = logger.getEnvironment(); // "development"

// –ò–∑–º–µ–Ω–∏—Ç—å environment (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
logger.setEnvironment('testing');
```

### Batch –æ—Ç–ø—Ä–∞–≤–∫–∞:

```typescript
await logger.logBatch([
  { level: 'INFO', message: '–°–æ–æ–±—â–µ–Ω–∏–µ 1', jsonPayload: { data: 1 } },
  { level: 'WARN', message: '–°–æ–æ–±—â–µ–Ω–∏–µ 2', jsonPayload: { data: 2 } },
  { level: 'ERROR', message: '–°–æ–æ–±—â–µ–Ω–∏–µ 3', jsonPayload: { data: 3 } },
]);
```

## üîÑ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è

### 1. –£–±–æ—Ä–∫–∞ –∫–æ–¥–∞ (OPTIONAL):

- –£–¥–∞–ª–∏—Ç—å `yandexCloudLogger.ts` (REST API –≤–µ—Ä—Å–∏—é)
- –û—á–∏—Å—Ç–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

- –ü–æ–¥–∫–ª—é—á–∏—Ç—å SDK-–ª–æ–≥–≥–µ—Ä –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π
- –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 3. –ü—Ä–æ–¥–∞–∫—à–Ω –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞:

- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–æ—Ç–∞—Ü–∏—é –ª–æ–≥–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ —É—Ä–æ–≤–Ω—é –≤–∞–∂–Ω–æ—Å—Ç–∏
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –≤ Yandex Cloud

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (15.06.2025)

### REST API (–ù–ï –†–ê–ë–û–¢–ê–ï–¢):

```
‚ùå –í—Å–µ endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 404:
- /logging/v1/write
- /v1/write
- /logging/v1/LogIngestion/Write
- /v1/LogIngestion/Write
‚úÖ Fallback –Ω–∞ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç
```

### SDK (–†–ê–ë–û–¢–ê–ï–¢):

```
‚úÖ –í—Å–µ –ª–æ–≥–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ:
- INFO: "SDK: –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ INFO"
- WARN: "SDK: –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ"
- ERROR: "SDK: –¢–µ—Å—Ç–æ–≤–∞—è –æ—à–∏–±–∫–∞"
- BATCH: 3 —Å–æ–æ–±—â–µ–Ω–∏—è
‚úÖ Response: WriteResponse –±–µ–∑ –æ—à–∏–±–æ–∫
```

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Yandex Cloud Logging –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!**

- ‚úÖ –õ–æ–≥–∏ –¥–æ—Ö–æ–¥—è—Ç –¥–æ –æ–±–ª–∞–∫–∞
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ Fallback —Å–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç —Å–±–æ–µ–≤
- ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

**–û—Å–Ω–æ–≤–Ω–æ–π –≤—ã–≤–æ–¥:** –î–ª—è —Ä–∞–±–æ—Ç—ã —Å Yandex Cloud Logging –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π SDK (gRPC), REST API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–æ–≤.
